抛出一个问题,为什么需要内存调优,你遇到过多少次需要内存调优才能解决的情况?

5年工作经验的我,能遇上的次数也不太多(低于100次)。基本都是在后期找补问题的时候,才会碰上。上一篇是详细的介绍我最近两次的排查问题的方式

自问自答的解答一下问题

一般是根据什么指标决定要人工介入gc调优
- MinorGC 执行时间不到50ms；
- Minor GC 执行不频繁，约10秒一次；
- Full GC 执行时间不到1s；
- Full GC 执行频率不算频繁，不低于10分钟1次。

## 为什么需要内存调优？
> young gc次数太多,有影响吗? 会有,但是影响不太大
> full gc次数太多,太频繁有影响吗? 肯定会有,调优也就是为了解决这个核心问题

young区存放的都是朝生夕死的对象, 众所周知,默认15次gc后,还存活的对象就会被放入到old区。young:old默认是1:2的比例, 这种机制从理论上分析,
大部分程序都是足够的。

old区 如果达到内存上限会立刻触发full gc。full gc的后果就是stw==>超过1s,就会使用带来影响,大量的用户超时,以及有可能出现的oom 程序崩溃。


## 排查问题
> 略


## 优化
- 架构调优
> 架构的选型就决定了这个方式能走多远,主要考虑扩展性的方式写代码
- 代码调优
> 推荐使用arthas排查问题,参考使用案例[https://github.com/alibaba/arthas/issues?page=1&q=label%3Auser-case](https://github.com/alibaba/arthas/issues?page=1&q=label%3Auser-case)
- JVM调优
> 增大内存参数,设置比例,关闭system.gc等命令,设置元空间的内存上限等等
- 数据库调优
> 关注慢sql,索引等
- 操作系统调优
> 句柄数,tcp的熟悉等

## 总结
> 调优是一个很枯燥但能带来些许成就感的流程,大部分的问题,基本都是代码问题。 认真点写代码,过一过脑子


WORK HARD! HAPPY HARD!








